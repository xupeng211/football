# 开发规则

## 🚀 核心原则

1. **所有代码必须通过 `make ci-check`。**
2. **禁止写未使用的变量、未导入的包。**
3. **所有函数必须写类型注解。**
4. **单测必须覆盖主要逻辑，避免 CI 红灯。**
5. **写代码前自动检查 CI 配置（pyproject.toml、Makefile），遵循其中规则。**

## 📋 提交前检查清单

- [ ] 运行 `make ci-check` 并确保通过
- [ ] 新增代码包含适当的类型注解
- [ ] 导入的包都被使用
- [ ] 变量命名符合 snake_case 规范
- [ ] 函数和类有适当的文档字符串
- [ ] 新增功能有对应的测试

## 🔧 质量标准

- **代码格式**: 使用 ruff format (自动格式化)
- **代码规范**: 遵循 ruff check 规则
- **类型检查**: 通过 mypy 检查
- **测试覆盖**: 主要逻辑路径需要有测试
- **复杂度控制**: 函数复杂度不超过 10

## ⚠️ 禁止事项

- 不要提交未通过 `make ci-check` 的代码
- 不要使用 `# type: ignore` 除非有充分理由
- 不要忽略 linter 警告
- 不要提交包含 `print()` 调试语句的代码（使用 logging 代替）
- 不要直接修改 CI 配置绕过检查

## 🎯 AI 编程最佳实践

- 在修改代码前先理解现有的质量配置
- 生成代码时确保符合项目的类型注解标准
- 优先修复质量问题而不是功能实现
- 保持代码简洁、可读、可测试
