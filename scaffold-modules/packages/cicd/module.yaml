# ğŸ”§ CI/CDæ¨¡å—é…ç½®
# CI/CD Module - å®Œæ•´çš„æŒç»­é›†æˆå’Œéƒ¨ç½²æµæ°´çº¿

name: "cicd"
display_name: "ğŸ”§ CI/CDæµæ°´çº¿æ¨¡å—"
version: "2.0.0"
description: "å®Œæ•´çš„CI/CDæµæ°´çº¿ï¼ŒåŒ…å«ä»£ç è´¨é‡æ£€æŸ¥ã€å®‰å…¨æ‰«æã€è‡ªåŠ¨åŒ–æµ‹è¯•ç­‰"

# æ¨¡å—ç±»å‹
type: "feature"
required: false

# ä¾èµ–å…³ç³»
dependencies:
  - "core" # ä¾èµ–æ ¸å¿ƒæ¨¡å—

# å†²çªæ¨¡å—
conflicts: []

# å­æ¨¡å—æ”¯æŒ
sub_modules:
  basic:
    description: "åŸºç¡€CIæµç¨‹"
    files:
      - ".github/workflows/ci.yml"
      - "scripts/ci-unified.sh"

  security:
    description: "å®‰å…¨æ‰«æå¢å¼º"
    files:
      - ".github/workflows/security.yml"
      - ".gitleaks.toml"
      - ".github/workflows/codeql.yml"

  advanced:
    description: "é«˜çº§ç›‘æ§å’Œé€šçŸ¥"
    files:
      - ".github/workflows/coverage.yml"
      - ".github/workflows/notify-on-failure.yml"

# æ¨¡å—æ–‡ä»¶åˆ—è¡¨
files:
  # GitHub Actionså·¥ä½œæµ
  - src: ".github/workflows/ci.yml"
    dest: ".github/workflows/ci.yml"
    type: "workflow"
    description: "ä¸»CIæµæ°´çº¿"
    sub_module: "basic"

  - src: ".github/workflows/security.yml"
    dest: ".github/workflows/security.yml"
    type: "workflow"
    description: "å®‰å…¨æ‰«æå·¥ä½œæµ"
    sub_module: "security"

  - src: ".github/workflows/coverage.yml"
    dest: ".github/workflows/coverage.yml"
    type: "workflow"
    description: "è¦†ç›–ç‡ç›‘æ§å·¥ä½œæµ"
    sub_module: "advanced"

  # CIè„šæœ¬
  - src: "scripts/ci-unified.sh"
    dest: "scripts/ci-unified.sh"
    type: "script"
    description: "ç»Ÿä¸€CIæ£€æŸ¥è„šæœ¬"
    sub_module: "basic"

  - src: "scripts/pre-push-check.sh"
    dest: "scripts/pre-push-check.sh"
    type: "script"
    description: "æ¨é€å‰æ£€æŸ¥è„šæœ¬"
    sub_module: "basic"

  - src: "scripts/quality-check.py"
    dest: "scripts/quality-check.py"
    type: "script"
    description: "ä»£ç è´¨é‡æ£€æŸ¥è„šæœ¬"
    sub_module: "basic"

  # é…ç½®æ–‡ä»¶
  - src: ".pre-commit-config.yaml"
    dest: ".pre-commit-config.yaml"
    type: "config"
    description: "Pre-commité’©å­é…ç½®"
    sub_module: "basic"

  - src: ".gitleaks.toml"
    dest: ".gitleaks.toml"
    type: "config"
    description: "ç§˜å¯†æ³„éœ²æ£€æµ‹é…ç½®"
    sub_module: "security"

  - src: ".coveragerc"
    dest: ".coveragerc"
    type: "config"
    description: "æµ‹è¯•è¦†ç›–ç‡é…ç½®"
    sub_module: "advanced"

# å®‰è£…åæ‰§è¡Œçš„å‘½ä»¤
post_install:
  commands:
    - "chmod +x scripts/ci-*.sh scripts/pre-push-check.sh"
    - "pre-commit install"
    - "pre-commit install --hook-type pre-push"

  messages:
    - "ğŸ‰ CI/CDæ¨¡å—å®‰è£…å®Œæˆï¼"
    - "ğŸ”§ Pre-commité’©å­å·²å®‰è£…"
    - "ğŸš€ è¿è¡Œ scripts/ci-unified.sh --mode=quick è¿›è¡Œå¿«é€Ÿæ£€æŸ¥"
    - "ğŸ›¡ï¸ å®‰å…¨æ‰«æå’Œè´¨é‡é—¨ç¦å·²é…ç½®"

# ç³»ç»Ÿè¦æ±‚
requirements:
  git: ">=2.30"
  pre-commit: ">=2.15.0"

# åŠŸèƒ½ç‰¹æ€§
features:
  - "continuous_integration"
  - "code_quality"
  - "security_scanning"
  - "automated_testing"
  - "pre_commit_hooks"

# ä¼°ç®—æŒ‡æ ‡
metrics:
  files_count: 12
  install_time_seconds: 45
  setup_complexity: "medium"
  maintenance_effort: "low"

# ç‰ˆæœ¬å†å²
changelog:
  "2.0.0":
    - "ç»Ÿä¸€CIè„šæœ¬é›†æˆ"
    - "å¢å¼ºå®‰å…¨æ‰«æ"
    - "ä¼˜åŒ–å·¥ä½œæµæ€§èƒ½"
  "1.0.0":
    - "åˆå§‹CI/CDå®ç°"
