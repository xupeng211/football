# Gitleaks configuration for Football Prediction System
title = "Gitleaks Configuration"

[extend]
# No external config to extend

[allowlist]
description = "Global allowlist to reduce false positives"

# Allowlist file paths
paths = [
  '''^docs?/.*$''',
  '''^tests?/.*\.py$''',
  '''^\.github/workflows/.*\.yml$''',
  '''^\.github/workflows/.*\.yaml$''',
  '''^.*\.md$''',
  '''^.*\.rst$''',
  '''^.*\.txt$''',
  '''^\.env\.example$''',
  '''^requirements.*\.txt$''',
  '''^pyproject\.toml$''',
  '''^\.pre-commit-config\.yaml$''',
  '''^Makefile$''',
]

# Allowlist regex patterns
regexes = [
  # GitHub Actions variables
  '''(?i)GITHUB_(TOKEN|REF|SHA|ACTOR|REPOSITORY|WORKFLOW|RUN_ID|RUN_NUMBER|EVENT_NAME)''',
  '''(?i)ACTIONS_(RUNNER|CACHE|ALLOW_|STEP_|RUNNER_).*''',

  # Common development patterns
  '''(?i)(dummy|example|sample|test|mock|fake)[-_]?(key|token|secret|password)''',
  '''(?i)localhost(:\d+)?''',
  '''(?i)127\.0\.0\.1(:\d+)?''',
  '''(?i)(jwt|bearer)\s+(token|key)''',

  # Database connection strings (example patterns)
  '''postgresql://.*:.*@localhost''',
  '''sqlite:///.*\.db''',

  # Development/test credentials
  '''test_api_key_\w+''',
  '''dev_secret_\w+''',
  '''mock_token_\w+''',
]

# Global settings
[entropy]
target = 4.5   # Higher threshold to reduce false positives

# Custom rules (if needed)
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|token)[^a-zA-Z0-9]["']?[a-z0-9]{20,}["']?'''
entropy = 4.0
tags = ["key", "API"]

# Additional allowlist for this rule
allowlist = {
  regexes = [
    '''(?i)GITHUB_TOKEN''',
    '''(?i)test[-_].*''',
    '''(?i)example[-_].*''',
    '''(?i)dummy[-_].*''',
  ]
}
