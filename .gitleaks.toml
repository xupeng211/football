# Gitleaks configuration file
title = "Gitleaks config for Football Prediction System"

[extend]
useDefault = true

[allowlist]
description = "Global allowlist to reduce false positives"
paths = [
  '''^docs?/.*$''',
  '''^tests?/.*\.py$''',
  '''\.github/workflows/.*\.yml$''',
  '''\.github/workflows/.*\.yaml$''',
  '''^.*\.md$''',
  '''^.*\.rst$''',
  '''^.*\.txt$''',
  '''\.env\.example$''',
  '''^requirements.*\.txt$''',
  '''^pyproject\.toml$''',
  '''\.pre-commit-config\.yaml$''',
  '''^Makefile$''',
]

regexes = [
  '''(?i)GITHUB_TOKEN''',
  '''(?i)test[-_].*''',
  '''(?i)example[-_].*''',
  '''(?i)dummy[-_].*''',
  '''(?i)fake[-_].*''',
  '''(?i)mock[-_].*''',
  '''(?i)placeholder''',
  '''(?i)your[-_].*[-_]here''',
  '''(?i)change[-_]me''',
  '''(?i)replace[-_].*''',
  '''(?i)TODO''',
  '''(?i)FIXME''',
  '''(?i)sqlite:///''',
  '''(?i)postgresql://.*:.*@localhost''',
  '''(?i)mysql://.*:.*@localhost''',
  '''(?i)redis://localhost''',
]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|token)[^a-zA-Z0-9]["']?[a-z0-9]{20,}["']?'''
entropy = 4.0
tags = ["key", "API"]

[rules.allowlist]
regexes = [
  '''(?i)GITHUB_TOKEN''',
  '''(?i)test[-_].*''',
  '''(?i)example[-_].*''',
]
