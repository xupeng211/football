{
    "project_info": {
        "name": "football-predict-system",
        "type": "python-ml-api",
        "security_level": "production"
    },
    "security_rules": {
        "forbidden_patterns": {
            "imports": [
                "import pickle",
                "from pickle import",
                "pickle.loads",
                "pickle.load",
                "exec(",
                "eval(",
                "os.system(",
                "subprocess.call"
            ],
            "code_patterns": [
                "password.*=.*[\"'][^\"']{1,8}[\"']",
                "secret.*=.*[\"'][^\"']{1,16}[\"']",
                "api_key.*=.*[\"'][^\"']{1,16}[\"']",
                "token.*=.*[\"'][^\"']{1,16}[\"']",
                "host.*=.*[\"']0\\.0\\.0\\.0[\"']",
                "allow_origins.*=.*\\[\\s*[\"']\\*[\"']\\s*\\]",
                "debug.*=.*True"
            ],
            "file_contents": [
                "password123",
                "admin123",
                "secret123",
                "your_secret_key",
                "change_me",
                "TODO: change this"
            ]
        },
        "required_patterns": {
            "config_files": [
                "field_validator.*secret",
                "pydantic_settings.*BaseSettings",
                "@validator.*password"
            ],
            "security_headers": [
                "X-Content-Type-Options",
                "X-Frame-Options",
                "X-XSS-Protection",
                "Strict-Transport-Security"
            ],
            "environment_variables": [
                "SECRET_KEY",
                "DATABASE_URL",
                "REDIS_URL"
            ]
        },
        "secure_alternatives": {
            "pickle": {
                "alternatives": [
                    "json",
                    "joblib",
                    "safetensors"
                ],
                "reason": "pickle is unsafe for untrusted data",
                "example": "Use json.dumps/loads for data, joblib.dump/load for ML models"
            },
            "exec": {
                "alternatives": [
                    "ast.literal_eval",
                    "safe_eval"
                ],
                "reason": "exec allows arbitrary code execution",
                "example": "Use ast.literal_eval for safe evaluation"
            },
            "hardcoded_secrets": {
                "alternatives": [
                    "os.environ.get",
                    "pydantic.SecretStr"
                ],
                "reason": "secrets should come from environment variables",
                "example": "password = os.environ.get('DB_PASSWORD')"
            },
            "bind_all_interfaces": {
                "alternatives": [
                    "127.0.0.1",
                    "specific_ip"
                ],
                "reason": "0.0.0.0 exposes service to all networks",
                "example": "host = '127.0.0.1' for local only"
            }
        }
    },
    "dependency_security": {
        "vulnerable_packages": [
            "requests<2.31.0",
            "urllib3<2.0.0",
            "pyyaml<6.0",
            "jinja2<3.1.0",
            "flask<2.3.0"
        ],
        "banned_packages": [
            "pickle5",
            "dill",
            "cloudpickle"
        ],
        "security_scanners": [
            "bandit",
            "safety",
            "semgrep",
            "pip-audit"
        ]
    },
    "configuration_security": {
        "environment_separation": {
            "development": {
                "debug": true,
                "cors_origins": [
                    "http://localhost:*"
                ],
                "log_level": "DEBUG"
            },
            "production": {
                "debug": false,
                "cors_origins": "specific_domains_only",
                "log_level": "INFO",
                "require_https": true
            }
        },
        "secret_management": {
            "min_secret_length": 32,
            "require_env_vars": true,
            "rotation_reminder": "90_days",
            "entropy_check": true
        }
    },
    "ai_guidance_templates": {
        "pickle_warning": "âš ï¸ æ£€æµ‹åˆ°pickleä½¿ç”¨ - è¿™å­˜åœ¨å®‰å…¨é£Žé™©ï¼å»ºè®®ä½¿ç”¨: {alternatives}",
        "weak_secret": "ðŸ”’ æ£€æµ‹åˆ°å¼±å¯†é’¥ - é•¿åº¦åº”è‡³å°‘32å­—ç¬¦ï¼Œå»ºè®®ç”Ÿæˆéšæœºå¯†é’¥",
        "hardcoded_secret": "âŒ æ£€æµ‹åˆ°ç¡¬ç¼–ç å¯†é’¥ - åº”ä½¿ç”¨çŽ¯å¢ƒå˜é‡: os.environ.get('{key}')",
        "insecure_binding": "ðŸŒ æ£€æµ‹åˆ°ä¸å®‰å…¨çš„ç½‘ç»œç»‘å®š - è€ƒè™‘ä½¿ç”¨ '127.0.0.1' æˆ–å…·ä½“IP",
        "debug_in_prod": "ðŸ› æ£€æµ‹åˆ°ç”Ÿäº§çŽ¯å¢ƒdebug=True - è¿™ä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯",
        "cors_wildcard": "ðŸ”“ æ£€æµ‹åˆ°CORSé€šé…ç¬¦ - ç”Ÿäº§çŽ¯å¢ƒåº”æŒ‡å®šå…·ä½“åŸŸå",
        "missing_validation": "ðŸ“ ç¼ºå°‘è¾“å…¥éªŒè¯ - å»ºè®®æ·»åŠ  pydantic validators",
        "dependency_vulnerability": "ðŸ” æ£€æµ‹åˆ°ä¾èµ–æ¼æ´ž - è¯·å‡çº§ {package} åˆ° {safe_version}"
    },
    "automated_fixes": {
        "secret_generation": {
            "command": "python -c \"import secrets; print(secrets.token_urlsafe(32))\"",
            "description": "ç”Ÿæˆ32å­—ç¬¦çš„å®‰å…¨å¯†é’¥"
        },
        "security_headers": {
            "template": "src/templates/security_headers.py",
            "description": "æ·»åŠ æ ‡å‡†å®‰å…¨å¤´"
        },
        "input_validation": {
            "template": "src/templates/pydantic_validators.py",
            "description": "æ·»åŠ è¾“å…¥éªŒè¯"
        }
    },
    "compliance_checks": {
        "owasp_top10": [
            "injection_prevention",
            "broken_authentication",
            "sensitive_data_exposure",
            "xml_external_entities",
            "broken_access_control",
            "security_misconfiguration",
            "cross_site_scripting",
            "insecure_deserialization",
            "known_vulnerabilities",
            "insufficient_logging"
        ],
        "required_tools": [
            "bandit",
            "safety",
            "pre-commit"
        ]
    },
    "integration": {
        "pre_commit_hooks": [
            "security-lint",
            "secret-scan",
            "dependency-check"
        ],
        "ci_cd_checks": [
            "security-audit",
            "dependency-scan",
            "secret-detection"
        ],
        "ide_integration": {
            "vscode_tasks": [
                "ðŸ”’ AI: å®‰å…¨æ£€æŸ¥",
                "ðŸ” AI: æ‰«æç§˜å¯†",
                "ðŸ“¦ AI: ä¾èµ–å®¡è®¡"
            ]
        }
    }
}