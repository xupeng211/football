# è¶³çƒé¢„æµ‹ç³»ç»Ÿ MVP

## ğŸ¯ æ¦‚è¿°

è¿™æ˜¯è¶³çƒé¢„æµ‹ç³»ç»Ÿçš„MVPï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰ç‰ˆæœ¬ï¼Œå®ç°äº†ä»æ•°æ®æ‘„å–åˆ°é¢„æµ‹æœåŠ¡çš„å®Œæ•´æµç¨‹ã€‚

**åŠŸèƒ½é—­ç¯ï¼š** æ•°æ®æ‘„å– â†’ ç‰¹å¾æŠ½å– â†’ è®­ç»ƒ XGBoost â†’ è¯„ä¼°ä¸ç™»è®° â†’ FastAPI é¢„æµ‹æ¥å£ â†’ Docker Compose æœ¬åœ°è¿è¡Œ

## ğŸ—ï¸ æ¶æ„

```
æ•°æ®å±‚          å¤„ç†å±‚          æ¨¡å‹å±‚          æœåŠ¡å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgreSQLâ”‚    â”‚ç‰¹å¾å·¥ç¨‹  â”‚    â”‚XGBoost  â”‚    â”‚FastAPI  â”‚
â”‚   +     â”‚ => â”‚  +     â”‚ => â”‚è®­ç»ƒ/è¯„ä¼° â”‚ => â”‚é¢„æµ‹æ¥å£  â”‚
â”‚CSVæ ·ä¾‹  â”‚    â”‚æ•°æ®æ‘„å–  â”‚    â”‚æ¨¡å‹ä¿å­˜  â”‚    â”‚  +UI   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—

### 1. æ•°æ®å±‚

- **PostgreSQL**: å­˜å‚¨æ¯”èµ›ã€èµ”ç‡ã€ç‰¹å¾ã€æ¨¡å‹å’Œé¢„æµ‹æ•°æ®
- **CSVæ ·ä¾‹æ•°æ®**: `sql/sample/` ç›®å½•ä¸‹çš„æµ‹è¯•æ•°æ®

### 2. æ•°æ®æ‘„å– (`data_pipeline/ingest/`)

- `base.py`: æŠ½è±¡æ•°æ®æºæ¥å£
- `csv_adapter.py`: CSVæ–‡ä»¶é€‚é…å™¨

### 3. ç‰¹å¾å·¥ç¨‹ (`data_pipeline/features/`)

- `rolling.py`: æ»šåŠ¨ç»Ÿè®¡ç‰¹å¾ï¼ˆçƒé˜ŸçŠ¶æ€ã€è¿›çƒè¶‹åŠ¿ï¼‰
- `build.py`: ç‰¹å¾æ„å»ºä¸»å‡½æ•°

### 4. è®­ç»ƒæ¨¡å— (`trainer/`)

- `fit_xgb.py`: XGBoostå¤šåˆ†ç±»æ¨¡å‹è®­ç»ƒ

### 5. é¢„æµ‹æœåŠ¡ (`apps/api/`, `models/`)

- `predictor.py`: æ¨¡å‹åŠ è½½å’Œé¢„æµ‹é€»è¾‘
- `main.py`: FastAPIæ¥å£å®ç°

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <repo-url>
cd football-predict-system

# å®‰è£…ä¾èµ–
make install
source .venv/bin/activate
```

### 2. MVPç¯å¢ƒå¯åŠ¨

```bash
# å¯åŠ¨æ•°æ®åº“å’ŒAPIæœåŠ¡
make mvp-up

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
make mvp-logs
```

æœåŠ¡å¯åŠ¨åå¯è®¿é—®ï¼š

- APIæ–‡æ¡£: <http://localhost:8000/docs>
- å¥åº·æ£€æŸ¥: <http://localhost:8000/health>
- ç‰ˆæœ¬ä¿¡æ¯: <http://localhost:8000/version>

### 3. è®­ç»ƒæ¨¡å‹

```bash
# è®­ç»ƒXGBoostæ¨¡å‹
make train
```

æ¨¡å‹å°†ä¿å­˜åˆ° `models/xgb_{timestamp}/` ç›®å½•ã€‚

### 4. æµ‹è¯•é¢„æµ‹API

```bash
# æµ‹è¯•é¢„æµ‹æ¥å£
make test-api

# æˆ–è€…æ‰‹åŠ¨è°ƒç”¨
curl -X POST "http://localhost:8000/predict" \
  -H "Content-Type: application/json" \
  -d '[
    {
      "home": "Arsenal",
      "away": "Chelsea",
      "home_form": 2.1,
      "away_form": 1.8,
      "odds_h": 2.1,
      "odds_d": 3.3,
      "odds_a": 3.2
    }
  ]'
```

æœŸæœ›å“åº”ï¼š

```json
[
  {
    "home_win": 0.47,
    "draw": 0.28,
    "away_win": 0.25,
    "model_version": "xgb_20241227_143021"
  }
]
```

### 5. å®Œæ•´æ¼”ç¤º

```bash
# è¿è¡Œå®Œæ•´MVPæ¼”ç¤ºæµç¨‹
make mvp-demo
```

## ğŸ“Š API æ¥å£

### POST /predict

æ‰¹é‡é¢„æµ‹æ¯”èµ›ç»“æœ

**è¯·æ±‚ä½“ç¤ºä¾‹ï¼š**

```json
[
  {
    "home": "Manchester United",
    "away": "Liverpool",
    "home_form": 1.8,
    "away_form": 2.2,
    "odds_h": 2.5,
    "odds_d": 3.2,
    "odds_a": 2.8
  }
]
```

**å“åº”ç¤ºä¾‹ï¼š**

```json
[
  {
    "home_win": 0.35,
    "draw": 0.30,
    "away_win": 0.35,
    "model_version": "xgb_20241227_143021"
  }
]
```

### GET /health

å¥åº·æ£€æŸ¥æ¥å£

### GET /version

è·å–APIå’Œæ¨¡å‹ç‰ˆæœ¬ä¿¡æ¯

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# è¿è¡Œç‰¹å®šæµ‹è¯•
python -m pytest tests/test_ingest_csv.py -v
python -m pytest tests/test_features_rolling.py -v
python -m pytest tests/test_api_predict.py -v

# æŸ¥çœ‹è¦†ç›–ç‡
make cov
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ apps/api/           # FastAPIåº”ç”¨
â”œâ”€â”€ data_pipeline/      # æ•°æ®å¤„ç†ç®¡é“
â”‚   â”œâ”€â”€ ingest/        # æ•°æ®æ‘„å–
â”‚   â””â”€â”€ features/      # ç‰¹å¾å·¥ç¨‹
â”œâ”€â”€ trainer/           # æ¨¡å‹è®­ç»ƒ
â”œâ”€â”€ models/            # æ¨¡å‹å’Œé¢„æµ‹å™¨
â”œâ”€â”€ sql/               # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ schema.sql     # æ•°æ®åº“ç»“æ„
â”‚   â””â”€â”€ sample/        # æ ·ä¾‹æ•°æ®
â”œâ”€â”€ tests/             # å•å…ƒæµ‹è¯•
â”œâ”€â”€ docker-compose.mvp.yml  # MVPç¯å¢ƒé…ç½®
â”œâ”€â”€ Dockerfile.api     # APIæœåŠ¡é•œåƒ
â””â”€â”€ README_MVP.md      # æœ¬æ–‡æ¡£
```

## ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# ç¯å¢ƒç®¡ç†
make mvp-up           # å¯åŠ¨MVPç¯å¢ƒ
make mvp-down         # åœæ­¢MVPç¯å¢ƒ
make mvp-logs         # æŸ¥çœ‹æ—¥å¿—
make mvp-clean        # æ¸…ç†ç¯å¢ƒ

# æ•°æ®å’Œæ¨¡å‹
make ingest           # æ•°æ®æ‘„å–
make train            # è®­ç»ƒæ¨¡å‹
make serve            # å¯åŠ¨æœ¬åœ°API

# æµ‹è¯•å’Œè´¨é‡
make test             # è¿è¡Œæµ‹è¯•
make lint             # ä»£ç æ£€æŸ¥
make ci               # å®Œæ•´CIæ£€æŸ¥
```

## ğŸ“‹ æ•°æ®åº“ç»“æ„

### æ ¸å¿ƒè¡¨

- `teams`: çƒé˜Ÿä¿¡æ¯
- `matches`: æ¯”èµ›è®°å½•ï¼ˆå«ç»“æœï¼‰
- `odds_raw`: èµ”ç‡æ•°æ®
- `features`: ç‰¹å¾æ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰
- `models`: æ¨¡å‹æ³¨å†Œè¡¨
- `predictions`: é¢„æµ‹ç»“æœ

è¯¦è§ `sql/schema.sql`

## ğŸ¯ MVPéªŒæ”¶æ ‡å‡†

- âœ… èƒ½è®­ç»ƒï¼šä»æ ·ä¾‹æ•°æ®è®­ç»ƒXGBoostæ¨¡å‹
- âœ… èƒ½é¢„æµ‹ï¼šé€šè¿‡APIæ¥å£è¿›è¡Œæ‰¹é‡é¢„æµ‹
- âœ… èƒ½éªŒæ”¶ï¼šå®Œæ•´çš„æµ‹è¯•è¦†ç›–å’Œè´¨é‡æ£€æŸ¥
- âœ… å®¹å™¨åŒ–ï¼šDocker Composeä¸€é”®å¯åŠ¨
- âœ… æ–‡æ¡£åŒ–ï¼šå®Œæ•´çš„APIæ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜

## ğŸ”„ æ¸…ç†

```bash
# åœæ­¢å¹¶æ¸…ç†æ‰€æœ‰èµ„æº
make mvp-clean

# æˆ–è€…æ‰‹åŠ¨æ¸…ç†
docker-compose -f docker-compose.mvp.yml down -v
docker system prune -f
```

## ğŸ“ˆ åç»­æ‰©å±•

MVPç‰ˆæœ¬ä¸ºåç»­æ‰©å±•å¥ å®šäº†åŸºç¡€ï¼š

- å®æ—¶æ•°æ®æºæ¥å…¥
- æ›´å¤æ‚çš„ç‰¹å¾å·¥ç¨‹
- æ¨¡å‹ç‰ˆæœ¬ç®¡ç†å’ŒA/Bæµ‹è¯•
- æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦
- æ•°æ®è´¨é‡æ ¡éªŒ

---

**MVPç›®æ ‡ï¼š** ä¸€å‘¨å†…å®ç°èƒ½è®­ç»ƒã€èƒ½é¢„æµ‹ã€èƒ½éªŒæ”¶çš„å®Œæ•´ç³»ç»Ÿ âœ…
