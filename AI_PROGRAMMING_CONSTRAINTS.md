# 🤖 AI编程助手强制约束

## 🚫 **严格禁止的操作**

### ❌ **禁止跳过质检命令**

```bash
# 🚫 禁止使用以下命令:
git commit --no-verify
git push --no-verify
git commit -n
git push -n
git push --force-with-lease --no-verify
git push --force --no-verify
```

### ❌ **禁止忽略错误命令**

```bash
# 🚫 禁止使用以下模式:
make quality-gate || true
pytest || echo "tests failed but continuing"
ruff check . || echo "linting failed but continuing"
```

## ✅ **强制要求的工作流程**

### 🔄 **标准AI编程流程**

```bash
# 1. 发现质检问题
git commit  # 可能失败

# 2. 分析错误信息 (必须)
echo "❌ 质检失败，AI开始分析问题..."

# 3. 系统性修复 (必须)
echo "🔧 AI正在修复具体问题..."
# 修复代码质量、类型、安全等问题

# 4. 验证修复效果 (必须)
make quality-gate  # 必须通过

# 5. 重新提交 (必须)
git add .
git commit -m "fix: AI修复质量问题"

# 6. 安全推送 (必须)
git push origin main  # 触发pre-push检查
```

## 📋 **AI工具必须遵循的原则**

### 🎯 **核心原则**

1. **永不跳过质检** - 任何情况下都不使用`--no-verify`
2. **智能问题分析** - 读取并理解错误信息
3. **系统性修复** - 按类别解决问题，不要临时绕过
4. **持续验证** - 修复后立即验证效果
5. **完整解决** - 确保所有问题解决后再推送

### 🤖 **AI工具行为模式**

```
发现问题 → 分析类型 → 制定策略 → 系统修复 → 验证效果 → 继续或推送
   ↑_______________________________________________|
   (如果仍有问题，继续循环直到完全解决)
```

## 🔒 **多层防护机制**

### 第一层：Pre-commit Hooks

- 所有commit都会触发质检
- 包含格式、质量、类型、安全检查

### 第二层：Pre-push Hooks

- 推送前强制运行`make quality-gate`
- 即使commit跳过了检查，推送时仍会被拦截

### 第三层：远程CI

- GitHub Actions会重新执行所有检查
- 确保代码质量标准

## 📖 **AI工具学习指南**

### 🔍 **问题分析技巧**

1. **仔细阅读错误输出**
2. **识别问题类型**（格式、类型、安全等）
3. **制定针对性解决方案**
4. **优先修复高危问题**（安全>类型>格式）

### 🔧 **常见问题修复模式**

- **Ruff问题**: 中文标点、行长度、导入顺序
- **MyPy问题**: 类型注解、返回类型、类型转换
- **Bandit问题**: subprocess安全、硬编码密钥
- **测试问题**: 断言错误、依赖缺失

### 🎯 **成功标准**

✅ 所有质检工具返回0退出码
✅ make quality-gate完全通过
✅ git push成功执行（不被pre-push hook阻止）
✅ 远程CI保持绿灯状态

## 🛡️ **违规行为监控**

### ⚠️ **检测跳过行为**

项目会监控以下违规行为：

- 使用`--no-verify`标志
- 强制推送未经质检的代码
- 忽略质检错误继续操作

### 📊 **合规性评估**

AI工具的合规性将通过以下指标评估：

- 质检问题解决率
- 是否跳过检查
- 代码质量改进效果
- 远程CI成功率

---

**🤖 如果你是AI编程助手，请严格遵循以上约束！**
**🎯 你的价值在于智能解决问题，而不是简单跳过检查！**
